---
title: "My Functions"
output: html_notebook
---

<p id="0"><u><font size="5"><b>Table of contents</b></font></u></p>  
<a href="#1">[1]</a> Set Working Directory on any OS  
<a href="#2">[2]</a> Interactively Load in Files   
<a href="#3">[3]</a> Column to Row label  
<a href="#4">[4]</a> Dataframe Column Maxima  
<a href="#5">[5]</a> Set Max Lines Viewed  
<a href="#5">[6]</a> Text files - Vector similarity check  
<a href="#x">[X]</a> Notes  

<p id="1"><b><font size="5">Set Working Directory on any OS </b></font><a href="#0"><sup>Return</sup></a></p>
* Set working directory for all OS (in windows just use choose.dir)
```{r}
setWD <- function(){
  print("Note, requires 'tcltk' package", quote=FALSE)
  library(tcltk)
  setwd(tk_choose.dir())
  cat("Your selected directory is: \n", getwd())
  detach("package:tcltk", unload=TRUE)
}
```


<p id="2"><b><font size="5">Interactively Load in Files</b></font><a href="#0"><sup>Return</sup></a></p>
* Interactively Load in .BIOM or CSV/TSV files
* Added support for excel files
```{r}
loadFile <- function(){
  print("Currently only tab & comma separated files are supported")
  path <-  as.character(file.choose())
  cat('Selected: \n', path, '\n')
  cat('What type of file is this? \n BIOM(B), OTU/TAXA/OTHER(OTX) \n') #print() doesn't work with regex "\n", used cat() instead
  a <- tolower(readline('Enter here: '))
  if(a=='b'|a=='biom'){
    cat("Requires 'phyloseq' package.",'\n Please specify variable name for BIOM file \n')
    library(phyloseq)
    nameb <- readline('Enter here: ')
    assign(as.character(nameb),import_biom(path), envir=globalenv())
    cat("Please manually unload 'phyloseq' package if necessary \n")
  }else if(a=='otx' | a=='taxa' | a=='otu' | a=='other'){
                print("Is this file in excel format?")
    excel <- tolower(readline("Type Yes(Y) if so: "))
    if(excel == 'y' | excel == 'yes'){
      cat("Note requires 'readxl' & 'tidyverse' package \n")
      library(tidyverse)
      library(readxl)
      cat('Please specify variable name for OTU file \n')
      nameo <- readline('Enter here: ')
      cat('First row as column labels? \n')
      colN<- tolower(readline('Enter Yes(Y) if so: '))
      if(colN == 'y' | colN =='yes'){
          assign(as.character(nameo),read_excel(path, col_names = TRUE), envir=globalenv())
          cat("Please manually unload 'tidyverse' and/or 'readxl' packages if necessary \n")
          stop("Loaded into global environment", call. = FALSE)
      }else if(colN=='n' | colN =='no'){
          assign(as.character(nameo),read_excel(path, col_names = FALSE), envir=globalenv())
        cat("Please manually unload 'tidyverse' and/or 'readxl' packages if necessary \n")
        stop("Loaded into global environment", call. = FALSE)
      }else{
      cat("Invalid Entry, check your inputs and try again (not case but character sensitive)")
      Sys.sleep(1) ; return(loadFile())
      }
    }else{
    cat('Please specify if this file is Tab(tb) or comma(co) delimited \n')
    spfy <- tolower(readline('Enter here: '))
    cat('First row as column labels? \n')
    colN<- tolower(readline('Enter Yes(Y) if so: '))
    cat('First column as row labels? \n')
    rowN<- tolower(readline('Enter Yes(Y) if so: '))
    }
      if(a=='otx' & spfy =='tb' & colN=='y' & rowN=='y' | a=='otx' & spfy =='tb' & colN=='yes' & rowN=='y' | a=='otx' & spfy =='tb' & colN=='y' & rowN=='yes' | a=='otx' & spfy =='tb' & colN=='yes' & rowN=='yes'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=TRUE, row.names=1, sep="\t"), envir=globalenv())
    } 
      else if(a=='otx' & spfy =='tb' & colN=='n' & rowN=='y' | a=='otx' & spfy =='tb' & colN=='no' & rowN=='y' | a=='otx' & spfy =='tb' & colN=='n' & rowN=='yes' | a=='otx' & spfy =='tb' & colN=='no' & rowN=='yes'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=FALSE, row.names=1, sep="\t"), envir=globalenv())
    }
      else if(a=='otx' & spfy =='tb' & colN=='y' & rowN=='n' | a=='otx' & spfy =='tb' & colN=='yes' & rowN=='n' | a=='otx' & spfy =='tb' & colN=='y' & rowN=='no' | a=='otx' & spfy =='tb' & colN=='yes' & rowN=='no'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=TRUE, sep="\t"), envir=globalenv())
    }
      else if(a=='otx' & spfy =='tb' & colN=='n' & rowN=='n' | a=='otx' & spfy =='tb' & colN=='no' & rowN=='n' | a=='otx' & spfy =='tb' & colN=='n' & rowN=='no' | a=='otx' & spfy =='tb' & colN=='no' & rowN=='no'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=FALSE, sep="\t"), envir=globalenv())
    } 
      else if(a=='otx' & spfy =='co' & colN=='y' & rowN=='y' | a=='otx' & spfy =='co' & colN=='yes' & rowN=='y' | a=='otx' & spfy =='co' & colN=='y' & rowN=='yes' | a=='otx' & spfy =='co' & colN=='yes' & rowN=='yes'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=TRUE, row.names=1, sep=","), envir=globalenv())
    }
      else if(a=='otx' & spfy =='co' & colN=='n' & rowN=='y' | a=='otx' & spfy =='co' & colN=='no' & rowN=='y' | a=='otx' & spfy =='co' & colN=='n' & rowN=='yes' | a=='otx' & spfy =='co' & colN=='no' & rowN=='yes'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=FALSE, row.names=1, sep=","), envir=globalenv())
    }
      else if(a=='otx' & spfy =='co' & colN=='n' & rowN=='y' | a=='otx' & spfy =='co' & colN=='no' & rowN=='y' | a=='otx' & spfy =='co' & colN=='n' & rowN=='yes' | a=='otx' & spfy =='co' & colN=='no' & rowN=='yes'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=TRUE, sep=","), envir=globalenv())
    }
      else if(a=='otx' & spfy =='co' & colN=='n' & rowN=='n' | a=='otx' & spfy =='co' & colN=='no' & rowN=='n' | a=='otx' & spfy =='co' & colN=='n' & rowN=='no' | a=='otx' & spfy =='co' & colN=='no' & rowN=='no'){
        cat('Please specify variable name for OTU file \n')
        nameo <- readline('Enter here: ')
        assign(as.character(nameo),read.table(file=path, header=FALSE, sep=","), envir=globalenv())
      } else{
      cat("Invalid Entry, check your inputs and try again (not case but character sensitive)")
      Sys.sleep(1) ; return(loadFile())
    }
  }else{ 
    cat("Invalid Entry, check your inputs and try again (not case but character sensitive)")
    Sys.sleep(1) ; return(loadFile())
  }
}
```

<p id="3"><b><font size="5">Column to Row label</b></font><a href="#0"><sup>Return</sup></a></p>
* Get Highest(max) OTU in columns(Samples)
```{r}
coltorow <- function(x){
  cat("Note requires 'tidyverse' package \n")
  library(tidyverse)
  cat("\n Here are your column labels \n")
  cat(names(x), '\n', sep = " | ")
  cat('\n Select column label to turn into row label \n')
  b <- as.character(readline('Enter Here WITHOUT quotations or spaces: '))
  cat('Enter new variable name to store \n')
  newname <- as.character(readline('Enter Here: '))
  assign(newname,column_to_rownames(x,var = b), envir=globalenv())}
```

<p id="4"><b><font size="5">Dataframe Column Maxima</b></font><a href="#0"><sup>Return</sup></a></p>
* Get Highest(max) OTU in columns(Samples)

```{r}
#outputs samples per line in console
  colmax <- function(x){
    OriginalMax <- getOption("max.print")
    options(max.print = 999999999)   #Set max print in-case large number of OTUs in dataset
    a <- unlist(apply(x,2,which.max))  #Returns as list but unlist turns into vector
    b <- apply(x,2,max)
    cat("Here are the corresponding top OTUs \n", paste(names(a), a, sep=": ", collapse='\n'), '\n')
    print('Get max values for top samples?')
    c <- tolower(readline('Enter Yes(Y) or No(N): '))   #Not necessary, can remove the no (else if and else)
    if(c == 'yes' | c== 'y'){
      cat("Here are the corresponding max values \n", paste(names(b), b, sep=": ", collapse='\n'), '\n')
    }else if(c == 'no' | c=='n'){
      stop("exit", call. = FALSE)
    }else{
      print("Invalid input")
    }
    options(max.print = OriginalMax) #Returns back to orinal max print
  }
```
```{r}
#Alternative colmax (cleaner - Preferred)
  colmax <- function(x){
    a <- unlist(apply(x,2,which.max))   #Returns as list but unlist turns into vector, also returns row indicies of max OTU as values
    a1.0 <- names(a) #Returns with names from named vector 
    a1.1 <-   rownames(x)[apply(x,2,which.max)] #Returns with rownames of indicies instead of numbers
    #a2 <-unname(a) #Return with number indicies corresponding to row labels
    names(a1.1) <- a1.0 #make a new named list names(values) <- header names 
    b <- apply(x,2,max)
    c <- list(TopOTUnumber = a1.1, MaximaValues = b)                              #R doesn't like returning 2 results in a function, therefore need to put into a list
    c
  }  
```


<p id="5"><b><font size="5">Set Max Lines Viewed</b></font><a href="#0"><sup>Return</sup></a></p>
* Set how much lines can be viewed

```{r}
setMaxprint <- function(){
  cat("Your current max print is: ", getOption('max.print'))
  x <- as.numeric(readline(prompt="Set max lines to view: "))
  if(is.na(x)==TRUE){
    cat("You didn't enter a number! \n","Your current max lines is:", as.character(getOption("max.print")), "\n")
  }else{
    options(max.print=x)
    cat("You have set max lines to", as.character(getOption("max.print")))
  }
}
```

<p id="6"><b><font size="5">Text files - Vector similarity check</b></font><a href="#0"><sup>Return</sup></a></p>
* Check for similar lines between two text files
* Doesn't work on windows
* Function stops working if there is a empty newline

```{r}
vsimck <- function(){

c <- 1
d <- 0    
  
print("Choose text file used as baseline for comparison", quote=FALSE) ; Sys.sleep(1)
a <- readLines(file.choose())
a <- append(a, "NA") #Adding NA to the very last line of the text file will end script once it reaches end b/c of condiditonal
Sys.sleep(0.5) ; print("Okay! Next,", quote=FALSE)
print("Choose text file to compare to",quote=FALSE) ; Sys.sleep(1)
b <- readLines(file.choose())
print("Processing....", quote=FALSE) ; Sys.sleep(2) 
while(a[c] != is.na(a[c]) | a[c] != tail(a,n=1)){   #iterate from index  1(c) of vector         input(a) until end of input tail(a,n=1) 
  cat((d+1),')', agrep(pattern=b[c],a, value=T), '\n') 
  c <- c+1
  d <- d+1
}
}
```

  

<p id="x"><b><font size="5">Notes</b></font><a href="#0"><sup>Return</sup></a></p>
> t() is transpose = switch col and rows

> Saving plots  
https://stackoverflow.com/questions/35321775/save-all-plots-already-present-in-the-panel-of-rstudio

> do.call constructs and executes a function call from a name or a function and a list of arguments to be passed to it.

> Explaination of why paste() regex doesn't output properly even though it's applied [Here](https://stackoverflow.com/questions/32427152/r-use-tab-as-part-of-seperator)
