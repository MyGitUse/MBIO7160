---
title: "Chapter 2: Statistical Modeling"
output: html_notebook
---

library(here)
library(vcd)

<body>
      <font face = "Times New Roman">
  
<p id="0"><u><font size="5"><b>Table of contents</b></font></u></p>  
<a href="#1">[1]</a> Statistical Modeling
<br> &emsp; <a href="#2">[1.1]</a> Chapter summary
<br> &emsp; <a href="#3">[1.2]</a> The difference between statistical and probabilistic models
<br> &emsp; <a href="#4">[1.3]</a> A simple example of statistical modeling
<br> &emsp; <a href="#5">[1.4]</a> Classical statistics for classical data
<br> &emsp; <a href="#6">[1.5]</a> Binomial distributions and maximum likelihood
<br> &emsp; <a href="#7">[1.6]</a> More boxes:multinomial data
<br> &emsp; <a href="#8">[1.7]</a> The χ<sup>2</sup> distribution
<br> &emsp; <a href="#9">[1.8]</a> Chargaff’s Rule
<br> &emsp; <a href="#10">[1.9]</a> Example: occurrence of a nucleotide pattern in a genome
<br> &emsp; <a href="#11">[2.0]</a> Bayesian Thinking
<br> &emsp; <a href="#12">[2.1]</a> Excercises</br> 
<a href="#x">[X]</a> Misc.

* **

<p id="1"><b><font size="5">Statistical Modeling</b></font><a href="#0"><sup>Return</sup></a></p>
* Previous chapter = generative modelling using know parameters to calculate probabilities
  * Problem in real life - don't know which generative model to use and parameters are often unknown
  * Solution in this chapter - estimate parameters/model using data
    * **Upwards model** unlike the previous chapter (Top down)
      * AKA statistical infeence
  * Examples in this chapter are all parametric
    * models w/ low# unknown parameters
    * estimated parameters from data is denoted <span class="math inline">\(\widehat{\theta}\)</span>

* **

<p id="2"><b><font size="5">Chapter Summary</b></font><a href="#0"><sup>Return</sup></a></p>
* Working from data back to generating distibutions & how to estimate parameters for distribution
  * Statistical models w/ categorical outcomes (binomial & multinomial)
    * **Goodness of fit**
      * visualization + simulations to test if data fits multinomial model
      * Chi-square statistic
      * compare simulation + theory via qqplot
    * **Estimation**
      * Maximum likelihood & Bayesian estimation
        * ex) nt pattern discovery & halotype estimation
    * **Prior & posterior distirbution**
      * Previously studied data (ex) halotypes) give posterior data distribtuion
        * Add uncertainty to decisison
        * Priors have small effect on result if large amount of data
    * **CpG island & Markov Chains**
      * Dependency along DNA modelled via Markov transitions
        * Build scores based on likelihood ratios -> see if DNA seqs are CpG islands or not
      * Histogram of scores
        * Saw bimodal distribution (ch4)
      * Modelling based on training data (known sequences of known CpG islands used to classify input data)

* **

<p id="3"><b><font size="5">The difference between statistical and probabilistic models</b></font><a href="#0"><sup>Return</sup></a></p>
* Probabilistic analysis requires a known distribution model which explains the randomness in data well
  * Parameters values are provided
  * ex) CH1 epitope example
    * False positives occured w/ Bernoulli(p=0.01) per position
      * #patients assyed (size) & 100 different positions of the protein (size) were fully given parameters
      * Since parameters given P(X|θ) where x is observed and θ is known parameter value
      * Used poisson for null hypothesis model (parameter λ=0.5)
        * Found probability of seeing max value of >=7 (1-P(x<=(1-max))^n is around 10<sup>-4</sup> -> reject null
    * == mathematical deduction
* What if _size_ & _n_ was known but the _probability_ was not, and why was Poisson distribution chosen?
  * Use data and move upwards to estimate best probabilty model to use (Poisson, normal, or binomial) - denoted F
    * Then find parameters for the model chosen
    * == statistical inference
    
* **

<p id="4"><b><font size="5">A simple example of statistical modeling</b></font><a href="#0"><sup>Return</sup></a></p>
* 2 steps to modeling
  1. need reasonable probability distribution
    * ex) CH1 - discrete count data modelled via simple distributions (binomial, multinomial, Poisson)
    * <mark style='background-color:yellow'>Normal distribution often good measurement for continous data</mark>
      * Distributions may be more complex (CH4)
```{r}
# Ex) CH1 epitope problem w/o outlier(value 7)
  # which.max() finds position of max value so (-) means to remove that value/position
load(here("BookStuff", "data", "e100.RData"))
e99 = e100[-which.max(e100)]
```

* For this example, evaluate <mark style='background-color:lightblue'>**Goodness-of-fit** via visualization</mark>
  * Step1: find which distribtuion would fit data best by visualizing data
    * <mark style='background-color:yellow'>Discrete data = barplot of frequencies (this data)</mark>
    * <mark style='background-color:yellow'>Continous data = Histogram</mark>
    * Hard to decide which distribution best fits data without comparing distributions
      * Solution = use a goodness-of-fit diagram visualization technique **rootogram**
        * Hangs bars w/ observed counts using theoretical red points
          * Shows square root of observed seqs via bars dropping below x-axis
        * <mark style='background-color:yellow'>If counts == theoretical values then bottom of boxes(of boxplot) will align w/ x-axis</mark>
        
```{r}
barplot(table(e99), space=0.5, col="red", xlab="Levels", ylab="counts")

#rootogram aspect
library(vcd)
gf1 <-  goodfit(e99, "binomial")
rootogram(gf1, xlab="Levels" ,rect_gp=gpar(fill="green"), main="Binomial good-fit test")
gf1.1 <- goodfit(e99, "poisson") 
rootogram(gf1.1, xlab="Levels" ,rect_gp=gpar(fill="green"), main="Poisson good-fit test")
```

* Q) Calibrate plot w/ known parameter of lambda=0.05 to generte 100 Poisson distributed numbers ```rpois``` and generate rootogram
  * lambda is the poission mean of theroretical distribution (estimated by sample mean)
  * Solution
    * Poisson is determined by one parameter, lambda AKA the poisson mean
      * If we assume the data follows a Poisson distribution based upon the rootogram, then need to estimate lambda because parameter is missing
      * To do this, the estimated lambda value is denoted <span class="math inline">\(\hat{\lambda}\)</span> 
        * Or also known as the **maximum likelihood estimator (MLE)**
        * Note - outlier max value was removed beforehand to generate e99 and estimate Poisson distribtuion
          * Going to use e100 for this example because real world data wouldn't notice outliers
          * Outliers will increase the mean estimate of <span class="math inline">\(\hat{\lambda}\)</span>
            * More likely to observe an outlier max of 7 in null hypothesis H0 == Larger p-value
              *  <mark style='background-color:yellow'>If p-value is small, the analysis is probably due to something real</mark>
              * conservative: error on side of caution by assuming not detecting something
```{r}
# Estimate poisson parameter
  # 1) Tally up counts per level
table(e100) #this is what rpois with predicted mean should look like

 #2) Simulate different values for Poisson mean to see which value best fits data
   # e100 = 100 observed data (n) so
table(rpois(n=100,lambda=1))
table(rpois(n=100,lambda=2))
table(rpois(n=100,lambda=3))
```

* the counts for the tables generated with these predicted means are way different from the data
  
```


* **

<p id="5"><b><font size="5">Classical statistics for classical data</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="6"><b><font size="5">Binomial distributions and maximum likelihood</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="7"><b><font size="5">More boxes:multinomial data</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="8"><b><font size="5">he χ<sup>2</sup> distribution</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="9"><b><font size="5">Chargaff’s Rule</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="10"><b><font size="5">Example: occurrence of a nucleotide pattern in a genome</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="11"><b><font size="5">Bayesian Thinking</b></font><a href="#0"><sup>Return</sup></a></p>

* **
<p id="12"><b><font size="5">Excercises</b></font><a href="#0"><sup>Return</sup></a></p>


* **

<p id="x"><b><font size="5">Miscellaneous</b></font><a href="#0"><sup>Return</sup></a></p>

*Run* = *Ctrl+Shift+Enter*  
*Insert Chunk* =*Ctrl+Alt+I*  
*Preview*=*Ctrl+Shift+K*  

* μ = mean of normal distribution
* θ = multiple parameters for probability model
  * ex) binomial model θ=(n,p) -> 2 numbers n=positive integer & p=real number between 0 & 1

</body>
  